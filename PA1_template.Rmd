---
title: "Reproducible Research: Peer Assessment 1"
date: "2/24/2018"
output: html_document
keep_md: true
---

## Loading and preprocessing the data
```{r echo=TRUE}
install.packages("AppliedPredictiveModeling")
install.packages("lattice")
install.packages("lubridate")
install.packages("ggplot2")
install.packages("CORElearn")
install.packages("caret")
fileUrl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
download.file(fileUrl, destfile = paste0(getwd(), '/repdata%2Fdata%2Factivity.zip'), method = "curl")
unzip("repdata%2Fdata%2Factivity.zip",exdir = "data")
data <- read.csv("activity.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
summary(data)
str(data)
head(data)
data$date <- as.Date(data$date, format = "%Y-%m-%d")
data$interval <- factor(data$interval)
NA_index <- is.na(as.character(data$steps))
data_no_NA <- data[!NA_index,]
head(data_no_NA)
```
## 1. What is mean total number of steps taken per day?
Group and summarize the data using dplyr
```{r}
library(dplyr)
su <- tapply(activity$steps, activity$date, sum, na.rm=T)
```
Construct the histogram
```{r echo=TRUE}
library(ggplot2)
hist(su, xlab = "sum of steps per day", main = "histogram of steps per day")
```
Get the mean and median of the total number of steps taken per day
```{r echo=TRUE}
mean_su <- round(mean(su))
median_su <- round(median(su))

print(c("The mean is", mean_su))
```
```{r echo=TRUE}
print(c("The median is",median_su))
```
```{r echo=TRUE}
summary (AvgDay$mean.steps)
```

## 2. What is the daily activity pattern?
First, make the time series plot
```{r echo=TRUE}
mn_int <- tapply(activity$steps, activity$interval, mean, na.rm=T)
plot(mn_int ~ unique(activity$interval), type="l", xlab = "5-min interval")
```
Second, identify which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps.
```{r echo=TRUE}
mn_int[which.max(mn_int)]
```
So we can see the the maximum number of steps is 206 and that occurred at time interval 835.

## 3. Imputing mission values
```{r echo=TRUE}
table(is.na(activity) == TRUE)
```
```{r echo=TRUE}
summary(activity)
```
We have 2304 NAs, that are all in the steps category
## 4. Strategy for filling in the missing values
the mean for each single interval calculated over 61 days. So we'll use 61 to replace the NAs
```{r echo=TRUE}
activity2 <- activity  # creation of the dataset that will have no more NAs
for (i in 1:nrow(activity)){
    if(is.na(activity$steps[i])){
        activity2$steps[i]<- mn_int[[as.character(activity[i, "interval"])]]
    }
}
```
Now the missing values are filled up, so let's create the histogram
```{r echo=TRUE}
su2 <- tapply(activity2$steps, activity2$date, sum, na.rm=T)
hist(su2, xlab = "sum of steps per day", main = "histogram of steps per day")
```
Creating the new values:
```{r}
mean_su2 <- round(mean(su2))
median_su2 <- round(median(su2))
```
The new values are:
```{r echo=TRUE}
print(c("The mean without NA is", mean_su2)) 
print(c("and for comparison, the mean with NAs was...", mean_su))
```
```{r echo=TRUE}
print(c("The median is", median_su2))
print(c("and for comparison, the median with NAs was...", median_su))
```
```{r echo=TRUE}
summary(activity2)
```
We filled in the missing values!

## 5. Difference between weekdays and weekends?
Figuring out what we have here
```{r}
activity2$daysOfWeek <- factor(weekdays(activity2$date))
levels(activity2$daysOfWeek)
```
```{r}
levels(activity2$daysOfWeek) <- list(weekday = c("Monday", "Tuesday", "Wednesday", 
                                               "Thursday", "Friday"),
                                   weekend = c("Saturday", "Sunday"))
table(activity2$daysOfWeek)
```
Plotting the difference between weekday and weekend
```{r echo=TRUE}
meanSteps <- aggregate(activity2$steps, list(as.numeric(activity2$interval),activity2$daysOfWeek),        FUN = "mean")
names(meanSteps) <- c("interval","weekDays", "avgSteps")

xyplot(meanSteps$avgSteps ~ meanSteps$interval | meanSteps$weekDays, 
       layout = c(1, 2), type = "l", 
       xlab = "Interval", ylab = "Number of steps")
```
cool
